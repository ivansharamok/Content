<!DOCTYPE html>
<html>

<head>
    <title>Configure BasicAuthentication for Solr provider with Sitecore</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="keywords" content="Configure BasicAuthentication for Solr provider with Sitecore, solr, sitecore,indexing, Works on my machine" />
    <meta name="description" content="Configure BasicAuthentication for Solr provider with Sitecore, solr, sitecore,indexing, " />
    <meta name="theme-color" content="#2CA6CB"/>
    <link rel="shortcut icon" type="image/x-icon" media="screen" href="http://localhost:4000/favicon.ico" />
    <link rel="canonical" href="http://localhost:4000/2017-01-04/configure-basicauth-for-solr-provider/" />
    <link rel="alternate" type="application/rss+xml" title="Works on my machine" href="/feed.xml"  />

    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.bootcss.com/octicons/3.5.0/octicons.min.css" >
    <!-- <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/style.css" /> -->
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/style.css" />
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/highlight.css" />
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/post.css" />
    
    <!-- Hide resource from search bots for now -->
    <meta name="robots" content="noindex,nofollow">
</head>


<body>

    <header>
        <nav class="navbar navbar-tiffany rectangle" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://localhost:4000/">Works on my machine</a>
                    <p class="navbar-text">Notes, thoughts, experiments</p>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        
                        <li>
                        <a href="http://localhost:4000/" class="word-keep"><span class="octicon octicon-book"></span></span>&nbsp;&nbsp;Blog</a>
                        </li>
                        
                        
                        <li>
                            <a href="http://localhost:4000/archive/" class="word-keep"><span class="octicon octicon-repo"></span>&nbsp;&nbsp;Archive</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="http://localhost:4000/category/" class="word-keep"><span class="octicon octicon-list-unordered"></span>&nbsp;&nbsp;Category</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li><a href="#stq=" class="search-button"><span class="octicon octicon-search"></span></a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>



<div class="main">
    <div class="container">
        <div class="row">
    <div class="content col-lg-9">
        <div class="sheet post">
          <header>
            <h2>Configure BasicAuthentication for Solr provider with Sitecore</h2>
            <p class="post-meta">
                <span class="octicon octicon-clock"></span> Jan 4, 2017
            </p>
            <p class="post-tag">
                <span><a href="http://localhost:4000/category/#solr"><span class="octicon octicon-list-unordered"></span>&nbsp;solr</a></span>
                <span>
                    <a class="word-keep" href="http://localhost:4000/tags/#sitecore"><span class="octicon octicon-tag"></span>&nbsp;sitecore</a>
                    
                    <a class="word-keep" href="http://localhost:4000/tags/#indexing"><span class="octicon octicon-tag"></span>&nbsp;indexing</a>
                    
                </span>
            </p>
          </header>
          <hr class="boundary">
          <article>
            <ul id="markdown-toc">
  <li><a href="#configure-solr-basic-authentication-plugin" id="markdown-toc-configure-solr-basic-authentication-plugin">Configure Solr basic authentication plugin</a>    <ul>
      <li><a href="#create-securityjson-file" id="markdown-toc-create-securityjson-file">Create /security.json file</a></li>
      <li><a href="#upload-securityjson-to-zookeeper" id="markdown-toc-upload-securityjson-to-zookeeper">Upload /security.json to Zookeeper</a>        <ul>
          <li><a href="#any-solr-5x-or-6x" id="markdown-toc-any-solr-5x-or-6x">Any Solr 5.x or 6.x</a></li>
          <li><a href="#simplified-command-for-solr-630" id="markdown-toc-simplified-command-for-solr-630">Simplified command for Solr 6.3.0</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#configure-sitecore-search-provider-basic-authentication" id="markdown-toc-configure-sitecore-search-provider-basic-authentication">Configure Sitecore search provider basic authentication</a></li>
</ul>

<blockquote>
  <p>Approach in this article has been tested with Sitecore 8.2.1 and Solr 6.3.0</p>
</blockquote>

<h2 id="configure-solr-basic-authentication-plugin">Configure Solr basic authentication plugin</h2>

<p>Refer to official <a href="https://cwiki.apache.org/confluence/display/solr/Basic+Authentication+Plugin">Basic Authentication Plugin</a> article to understand how it can be configured.</p>

<blockquote>
  <p>Note<br />
Prior to Solr 6.3.0 there is an issue with <code class="highlighter-rouge">blockUnknown</code> property described in <a href="https://issues.apache.org/jira/browse/SOLR-9188">SOLR-9188</a>.</p>
</blockquote>

<p>Steps below provide example configuration of basic authentication plugin for Solr 6.3.0.</p>

<h3 id="create-securityjson-file">Create /security.json file</h3>

<p>This example configures basic authentication with user <code class="highlighter-rouge">solr</code> and password <code class="highlighter-rouge">SolrRocks</code></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"authentication"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"blockUnknown"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"solr.BasicAuthPlugin"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"credentials"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"solr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c="</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"authorization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"solr.RuleBasedAuthorizationPlugin"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"permissions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"security-edit"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"administrator"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"user-role"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"solr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"administrator"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<blockquote>
  <p>Note<br />
The <code class="highlighter-rouge">authorization</code> section in the example above does not provide sufficient permissions but rather provided as an example how it can be configured.</p>
</blockquote>

<h3 id="upload-securityjson-to-zookeeper">Upload /security.json to Zookeeper</h3>

<p>Execute one of the following commands to upload /security.json file into your Solr instance.</p>

<h4 id="any-solr-5x-or-6x">Any Solr 5.x or 6.x</h4>

<pre><code class="language-bat">server\scripts\cloud-scripts\zkcli.bat -zkhost localhost:9983 -cmd put /security.json security.json
</code></pre>

<h4 id="simplified-command-for-solr-630">Simplified command for Solr 6.3.0</h4>

<pre><code class="language-bat">bin\solr zk cp file:security.json zk:security.json -z localhost:9983
</code></pre>

<h2 id="configure-sitecore-search-provider-basic-authentication">Configure Sitecore search provider basic authentication</h2>

<p>Solr provider for Sitecore exposes <code class="highlighter-rouge">solrHttpWebRequestFactory</code> configuration section that allows you to configure corresponding C# class that handles Solr request authentication.
To configure Solr provider to use basic authentication patch <code class="highlighter-rouge">solrHttpWebRequestFactory</code> section:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;sitecore&gt;</span>
    <span class="nt">&lt;contentSearch&gt;</span>
      <span class="nt">&lt;indexConfigurations&gt;</span>
        <span class="nt">&lt;solrHttpWebRequestFactory</span> <span class="na">set:type=</span><span class="s">"HttpWebAdapters.BasicAuthHttpWebRequestFactory, SolrNet"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">hint=</span><span class="s">"username"</span><span class="nt">&gt;</span>solr<span class="nt">&lt;/param&gt;</span>
          <span class="nt">&lt;param</span> <span class="na">hint=</span><span class="s">"password"</span><span class="nt">&gt;</span>SolrRocks<span class="nt">&lt;/param&gt;</span>
        <span class="nt">&lt;/solrHttpWebRequestFactory&gt;</span>
      <span class="nt">&lt;/indexConfigurations&gt;</span>
    <span class="nt">&lt;/contentSearch&gt;</span>
  <span class="nt">&lt;/sitecore&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>Note<br />
There is a bug in Solr provider for Sitecore 8.2.1 which does not allow authentication to work properly.
Use <a href="https://github.com/SitecoreSupport/Sitecore.Support.141324">Sitecore.Support.141324</a> patch to work around this issue.<br />
If you don’t have access to the patch, contact <a href="https://support.sitecore.net/helpdesk/">Sitecore Support</a>.</p>
</blockquote>

<blockquote>
  <p>Note<br />
There is a bug in Solr provider in version 8.2.1 which does not allow you to create index collection aliases automatically via <code class="highlighter-rouge">ContentSearch.Solr.EnforceAliasCreation</code> setting.
If you want this feature, use patch <a href="https://github.com/SitecoreSupport/Sitecore.Support.124981">Sitecore.Support.124981</a>.</p>
</blockquote>

          </article>
          <hr class="boundary">
          <div id="post-share">
              <!-- Go to www.addthis.com/dashboard to customize your tools -->
              <div class="addthis_inline_share_toolbox"></div>
          </div>
        </div>
        <div class="pad-min"></div>
        <div id="post-comment" class="sheet post">
            <div id="disqus_thread"></div>
        </div>
    </div>
    <div class="content-navigation col-lg-3">
      <div class="shadow-bottom-center" >
        <div class="content-navigation-toc">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Toc
            </div>
            <div class="content-navigation-list toc"></div>
        </div>
        <div class="content-navigation-tag">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Tags
            </div>
            <div class="content-navigation-list">
                <ul>
                    
                    <li>
                        <a href="http://localhost:4000/tags#sitecore"><span class="octicon octicon-tag"></span>&nbsp;sitecore</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/tags#indexing"><span class="octicon octicon-tag"></span>&nbsp;indexing</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="content-navigation-related">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Related
            </div>
            <div class="content-navigation-list">
                <ul>
                    

                    

                    
                        
                            <li>
                                <a href="http://localhost:4000/2017-11-24/publishing-service-in-docker-container/">Sitecore Publishing Service in Docker Windows Container</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-11-07/run-solr-container-in-azure-kubernetes-cluster/">Run Solr container in Azure Kubernetes cluster (AKS)</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-25/run-your-container-in-azure/">Run your container in Azure</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-24/flexible-solr-container-image-for-sitecore/">Flexible Solr container image for Sitecore</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-20/run-solr+ssl-in-docker-container-with-sitecore-indexes/">Run Solr + SSL in Docker container with Sitecore indexes</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-03-30/dedicated-sitecore-processing-instance-for-reportingdb-historic-rebuild/">Dedicated Sitecore processing instance for reporting database historic rebuild</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-01-05/configure-sitecore-indexes-for-centralized-indexing-solution/">Configure Sitecore indexes for centralized indexing solution</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2016-12-30/script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/">MSDeploy Sitecore installation using SolrCloud with SwitchOnRebuild index</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2016-12-10/customize-sitecore-azuretoolkit-deployment/">Customize Sitecore Azure toolkit deployment</a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
      </div>
    </div>
</div>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a24c44d9a3c0d22"></script>
    </div>
    <div class="page-scrollTop" data-toggle="tooltip" data-placement="top" title="Top">
        <a href="javascript:void(0);">
            <div class="arrow"></div>
            <div class="stick"></div>
        </a>
    </div>
</div>

    <footer  class="footnote footnote-tiffany">
        <div class="container">
                <a class="foot-item" href="mailto:" target="_blank"><span class="octicon octicon-mail"></span></a>
                <a class="foot-item" href="https://github.com/ivansharamok" target="_blank"><span class="octicon octicon-mark-github"></span></a>
                <a class="foot-item" href="http://localhost:4000/feed.xml" target="_blank"><span class="octicon octicon-rss"></span></a>
                <!-- <a class="foot-item" href="http://localhost:4000/link/"><span class="octicon octicon-link-external"></span></a> -->
                &nbsp;
                <a href="http://blog.sharamok.com/"><span class="word-keep">&copy; Ivan Sharamok</span></a>
        </div>
        <div class="credit">
            Credit to WakelessDragon for <a href="https://github.com/WakelessDragon/blog">Jekyll site theme</a>.
        </div>
    </footer>
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://localhost:4000/static/js/script.js"></script>
    <script type="text/javascript" src="http://localhost:4000/static/js/post.js"></script>
    


</body>
</html>
